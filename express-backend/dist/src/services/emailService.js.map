{"version":3,"sources":["../../../src/services/emailService.ts"],"sourcesContent":["import nodemailer from 'nodemailer';\r\nimport dotenv from 'dotenv';\r\nimport fs from 'fs';\r\n\r\ndotenv.config();\r\n\r\nconst transporter = nodemailer.createTransport({\r\n\tservice: 'gmail',\r\n\tauth: {\r\n\t\tuser: process.env.EMAIL_USER,\r\n\t\tpass: process.env.EMAIL_PASS,\r\n\t},\r\n});\r\n\r\nexport const sendEmail = async (emailOptions: {\r\n\tfrom: string;\r\n\tto: string;\r\n\tsubject: string;\r\n\ttext: string;\r\n\tattachments?: { filename: string; path: string }[];\r\n}) => {\r\n\ttry {\r\n\t\tawait transporter.sendMail(emailOptions);\r\n\r\n\t\t// If email sent successfully and there are attachments, delete them\r\n\t\tif (emailOptions.attachments) {\r\n\t\t\temailOptions.attachments.forEach(attachment => {\r\n\t\t\t\tfs.unlink(attachment.path, (err) => {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tconsole.error(`Failed to delete file: ${attachment.path}`, err);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log(`File deleted: ${attachment.path}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn { success: true, message: 'Email sent successfully' };\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\t\treturn { success: false, message: 'Failed to send email' };\r\n\t}\r\n};\r\n"],"names":["nodemailer","dotenv","fs","config","transporter","createTransport","service","auth","user","process","env","EMAIL_USER","pass","EMAIL_PASS","sendEmail","emailOptions","sendMail","attachments","forEach","attachment","unlink","path","err","console","error","log","success","message"],"mappings":"AAAA,OAAOA,gBAAgB,aAAa;AACpC,OAAOC,YAAY,SAAS;AAC5B,OAAOC,QAAQ,KAAK;AAEpBD,OAAOE,MAAM;AAEb,MAAMC,cAAcJ,WAAWK,eAAe,CAAC;IAC9CC,SAAS;IACTC,MAAM;QACLC,MAAMC,QAAQC,GAAG,CAACC,UAAU;QAC5BC,MAAMH,QAAQC,GAAG,CAACG,UAAU;IAC7B;AACD;AAEA,OAAO,MAAMC,YAAY,OAAOC;IAO/B,IAAI;QACH,MAAMX,YAAYY,QAAQ,CAACD;QAE3B,oEAAoE;QACpE,IAAIA,aAAaE,WAAW,EAAE;YAC7BF,aAAaE,WAAW,CAACC,OAAO,CAACC,CAAAA;gBAChCjB,GAAGkB,MAAM,CAACD,WAAWE,IAAI,EAAE,CAACC;oBAC3B,IAAIA,KAAK;wBACRC,QAAQC,KAAK,CAAC,CAAC,uBAAuB,EAAEL,WAAWE,IAAI,CAAC,CAAC,EAAEC;oBAC5D,OAAO;wBACNC,QAAQE,GAAG,CAAC,CAAC,cAAc,EAAEN,WAAWE,IAAI,CAAC,CAAC;oBAC/C;gBACD;YACD;QACD;QAEA,OAAO;YAAEK,SAAS;YAAMC,SAAS;QAA0B;IAC5D,EAAE,OAAOH,OAAO;QACfD,QAAQC,KAAK,CAACA;QACd,OAAO;YAAEE,SAAS;YAAOC,SAAS;QAAuB;IAC1D;AACD,EAAE"}